<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "manual.ent">
<!ENTITY PRODUCT "Documentation">
<!ENTITY BOOKID "manual">
<!ENTITY YEAR "2015">
<!ENTITY HOLDER "Eneo Tecnología S.L. |">
]>
<chapter>
	<title>Eventos: IPS</title>
	<para>Gracias a redBorder, obtenga un control activo sobre el tráfico de su red. El análisis es el primer paso para mantener una política de seguridad eficaz. Pero es necesario disponer de algún medio que le permita intervenir en los momentos más críticos y de este modo, evitar que las amenazas se conviertan en ataques.</para>
	<para>La App IPS le garantiza una protección máxima de su red al tratarse de un sistema activo capaz de bloquear el tráfico procedente de una determinada IP o excluir un paquete para su análisis previo que resulte sospechoso o que cumpla con algunas de las reglas fijadas por el usuario.</para>
	<para>Visibilidad para el análisis y seguridad para el control activo, esta es la combinación que hace que, redBorder sea la mejor plataforma de inteligencia operacional Open Source del mercado. </para>
	<note>
		<title>Nota</title>
		<para>En la siguiente imagen podemos observar que la sección IPS presenta una estructura similar a la interfaz de la sección de Flow. Es por este motivo que, para conocer la estructura y operativa de la sección, el usuario puede consultar el capítulo "Eventos: Flow". </para>
	</note>
	<para>En el caso de la App IPS, las unidades de medida en las que se muestran los datos en la gráfica o agregación aprecen bajo el nombre <literal>Events</literal>.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img000.png"/>
			</imageobject>
			<textobject>
				<phrase>Vista general de la sección IPS</phrase>
			</textobject>
			<caption>
				<para>Vista general de la sección IPS</para>
			</caption>
		</mediaobject>
	<section>
		<title>Eventos</title>
		<para>En el submenú de cabecera encontramos la sección <emphasis>Events</emphasis> (entre las pestañas de Vista y granuralidad) que nos permite seleccionar la agregación para visualizar los eventos IPS.</para>
		<itemizedlist mark="bullet">
			<listitem>
				<para>Eventos (<literal>Events</literal>)</para>
			</listitem>
			<listitem>
				<para>Eventos por segundo (<literal>Events/s</literal>)</para>
			</listitem>
			<listitem>
				<para>Firmas (<literal>Signature</literal>)</para>
			</listitem>
		</itemizedlist>
		<note>
			<title>Nota</title>
			<para>Estas opciones aplican para la vistas Tops y Compare. En el caso de la vista Unique, no aplica; para la vista Raw se incluyen, además, otras opciones que se detallarán a continuación.</para>
		</note>
		<section>
			<title>Events</title> 
			<para>En las vistas <literal>Tops</literal> y <literal>Compare</literal> esta opción nos permite ver el total de eventos que se han sucedido según atributo. Al posar el ratón encima de la vista es posible visualizar la fecha, hora exactas y el número de eventos totales que se han registrado en ese periodo de tiempo para el atributo seleccionado.</para>
			<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img026.png"/>
					</imageobject>
				<textobject>
					<phrase>Eventos/sensor</phrase>
				</textobject>
				<caption>
					<para>Eventos/sensor</para>
				</caption>
			</mediaobject>
			<para>Recuerde que es posible un análisis más profundo añadiendo pestañas con atributos. Por ejemplo, en las siguientes capturas observamos el total de firmas que se han recibido en un periodo de tiempo determinado o en el segundo caso, el total de eventos generados por las IPs de origen que han interactuado con una red. </para>
			<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img027.png"/>
					</imageobject>	
					<textobject>
						<phrase>Eventos/firmas</phrase>
					</textobject>
					<caption>
						<para>Eventos/firmas</para>
					</caption>
				</mediaobject>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img028.png"/>
				</imageobject>
				<textobject>
					<phrase>Eventos/SRC</phrase>
				</textobject>
				<caption>
					<para>Eventos/SRC</para>
				</caption>
			</mediaobject>
		</section>
		<section>
			<title>Events/s</title> 
			<para>Muesta el total de eventos que se han producido en un segundo para un atributo dado. Nos ofrece el máximo grado de granuralidad.</para> 
			<mediaobject>
					<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img029.png"/>
				</imageobject>
				<textobject>
					<phrase>Eventos/s-firmas</phrase>
				</textobject>
				<caption>
					<para>Eventos/s-firmas</para>
				</caption>
			</mediaobject>
		</section>
		<section>
			<title>Signatures</title> 
			<para>Mediante esta opción el usuario podrá ver en la tabla de datos el número de firmas totales que se han ejecutado para un atributo dado: sensor, IPs de origen, IPs de destino, etc. En caso de que se haya añadido una pestaña con el atributo <literal>Signature</literal> se observará cómo la distribución de firmas por firma tiene, por lógica, un valor de 1. No obstante, el resumen nos aportará información muy útil. </para><!--no sé si esto es correcto-->
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img030.png"/>
				</imageobject>
				<textobject>
					<phrase>Firmas/sensor</phrase>
				</textobject>
				<caption>
					<para>Firmas/sensor</para>
				</caption>
			</mediaobject>
		</section>
	</section>
	<section>
		<title>Gestión de eventos IPS en la vista Raw</title>
		<para>La vista Raw nos permite visualizar todos los eventos recogidos por los sensores IPS por atributo y segmentados por franjas de tiempo. Combinado con el tipo de gráfica Stream nos permite, además, visualizar el flujo de datos que se está produciendo dentro de la red. </para>
		<para>Cada columna de la tabla de datos nos muestra los valores que corresponden con los atributos seleccionados, así como el intervalo de tiempo entre eventos (<literal>Timestamp</literal>).</para>
		<para>En esta tabla podemos realizar diferentes acciones:</para>
		<itemizedlist mark="bullet">
			<listitem>
				<para>Intervalo de tiempo o <literal>Timestamp:</literal> podemos consultar el intervalo de tiempo que se toma como referencia para mostrar el número de eventos que se han producido en ese tiempo.</para>
			</listitem>
			<listitem>
				<para>Consultar información del evento: haciendo clic sobre el icono de "Editar" para obtener una mayor granuralidad.</para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="350" fileref="images/ch11_img012.png"/>
					</imageobject>
					<caption>
						<para>Icono "Editar"</para>
					</caption>
				</mediaobject>
				<para>Cuando se ha llegado al límite de granuralidad en el que se pueden mostrar los eventos, este icono se transformará en el de información:</para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="350" fileref="images/ch11_img012b.png"/>
					</imageobject>
					<caption>
						<para>Detalle Timestamp: información del evento</para>
					</caption>
				</mediaobject>
				<para>Clicando sobre él accederemos a una pantalla en la que se nos proporciona la información completa asociada a cada uno de los eventos consignados en ese intervalo de tiempo.</para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img012.png"/>
					</imageobject>
					<caption>
						<para>Información del evento</para>
					</caption>
				</mediaobject>
			</listitem>
			<listitem>
				<para>Crear un objeto (<literal>Create object</literal>): algunos de los atributos que se muestran en la información del evento permiten la posibilidad de convertirlos en Objeto. Esto quiere decir, que a esos valores se les puede añadir un nombre y una descripción que permite la localización de un elemento de manera más rápida y sencilla.</para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img013.png"/>
					</imageobject>
					<caption>
						<para>Crear un objeto</para>
					</caption>
				</mediaobject>
			</listitem>
		</itemizedlist>
		<note>
			<title>Nota</title>
			<para>Recuerde que la máxima granuralidad disponible es de 1m.</para>
		</note>	
		<section>
			<title>Vista Raw: información del evento IPS</title>
			<para>Cuando llegamos al máximo de granuralidad disponible para la consulta de los eventos registrados por el sensor, accedemos a una pantalla en la que visualizaremos una ficha que incluye el detalle de la información asociada a los siguientes parámetros:</para>
			<itemizedlist mark="circle">
				<listitem>
					<para>Datalink</para>
				</listitem>
				<listitem>
					<para>Archivo</para>
				</listitem>
				<listitem>
					<para>IPS/IDS</para>
				</listitem>
				<listitem>
					<para>Localización</para>
				</listitem>
				<listitem>
					<para>Red</para>
				</listitem>
				<listitem>
					<para>Transporte</para>
				</listitem>
			</itemizedlist>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img034.png"/>
				</imageobject>
				<textobject>
					<phrase>Detalle información eventos</phrase>
				</textobject>
				<caption>
					<para>Detalle información eventos</para>
				</caption>
			</mediaobject>
		</section>
		<section>	
			<title>Vista Raw: reglas, políticas y acciones sobre eventos</title>
			<para>Además de la obtención de información detallada sobre cada uno de los eventos, es posible realizar acciones sobre los mismos que nos ayuden a gestionar su visualización para optimizar el análisis y monitorización de nuestras redes.</para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img035.png"/>
					</imageobject>
					<textobject>
						<phrase>Acciones para la visualización de eventos</phrase>
				</textobject>
				<caption>
					<para>Acciones para la visualización de eventos</para>
				</caption>
			</mediaobject>
			<para>Las acciones que se pueden realizar desde esta pantalla son las siguientes:</para>
			<itemizedlist mark="circle">
				<listitem>
					<para>References: nos permite consultar fuentes externas para obtener información sobre las vulnerabilidades conocidas.</para>
					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img014.png"/>
						</imageobject>
						<textobject>
							<phrase>Referencias: CVE</phrase>
						</textobject>
						<caption>
							<para>Referencias: CVE</para>
						</caption>
					</mediaobject>
				</listitem>
				<listitem>
					<para>View rule: información detallada sobre la regla asociada al sensor.</para>
					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img015.png"/>
						</imageobject>
						<textobject>
							<phrase>Rule information</phrase>
						</textobject>
						<caption>
							<para>Rule information</para>
						</caption>
					</mediaobject>
				</listitem>
				<listitem>
					<para>Policy rule: muestra la política o políticas aplicadas para activar la alerta que se está consultando. Esta opción incluye múltiples acciones sobre que se pueden realizar sobre las políticas y que se verán en el capítulo destinado a "Configuración de políticas".</para> 
					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img016.png"/>
						</imageobject>
						<textobject>
							<phrase>Policy rule</phrase>
						</textobject>
						<caption>
							<para>Policy rule</para>
						</caption>
					</mediaobject>
				</listitem>
				<listitem>
					<para>View Raw: permite la visualización de los datos del evento en bruto.</para>
					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img017.png"/>
						</imageobject>
						<textobject>
							<phrase>View Raw</phrase>
						</textobject>
						<caption>
							<para>View Raw</para>
						</caption>
					</mediaobject>
				</listitem>
				<listitem>
					<para>Event Supression: supresión de aquellos eventos recurrentes o de los que no necesitemos información.</para>
					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img018.png"/>
						</imageobject>
						<textobject>
							<phrase>Suprimir evento</phrase>
						</textobject>
						<caption>
							<para>Suprimir evento</para>
						</caption>
					</mediaobject>
				</listitem>
				<listitem>
					<para>Event Filtering: existen tres tipos de filtros para la visualización de los eventos; el usuario también puede determinar si el seguimiento de los eventos se realiza por fuente o por destino.</para>
					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img019.png"/>
						</imageobject>
						<textobject>
							<phrase>Filtrar evento</phrase>
						</textobject>
						<caption>
							<para>Filtrar evento</para>
						</caption>
					</mediaobject>
					<para>-Limit: limita el número de eventos que se muestran en un periodo de tiempo que hayamos indicado y que se encuentran bajo las formas seleccionadas, ignorando los demás eventos que se produzcan bajo la misma firma. </para>
					<para>-Threshold: Selecciona el número de veces que tiene que ocurrir un evento en un periodo de tiempo determinado para que se muestre la alerta.</para>
					<para>-Both: la alerta solo se muestra una vez por cada n veces que ha sucedido el evento en un periodo de tiempo determinado.</para>
				</listitem>
			</itemizedlist>		
		</section>
	</section>
	<section>
		<title>Atributos disponibles para IPS</title>
		<note>
			<title>Nota</title>
			<para>Las opciones que se muestran en la pestaña <literal>Add tab</literal> son los mismos para todas las vistas salvo en el caso de la vista Compare, que nos muestra como opciones la temporalidad con la que podemos consultar los eventos: semanal o mensual.</para>
		</note>
		<para>A continuación enumeramos los atributos que el usuario tiene disponibles para aplicar en el IPS y los diferentes aspectos que puede consultar de cada uno de ellos:</para>
		<itemizedlist mark="circle">
			<listitem>
				<para>Datalink</para>
				<para>-Ethelength</para>
				<para>-ICMP Type</para>
				<para>-SRC MAC</para>
				<para>-SRC Vendor</para>
				<para>-DST MAC</para>
				<para>-DST Vendor</para>
				<para>-TOS</para>
				<para>-TTL</para>
				<para>-VLAN ID</para>
			</listitem>
			<listitem>
				<para>File</para>
				<para>-SHA256</para>
				<para>-File size</para>
				<para>-File URI</para>
				<para>-File hostname</para>
			</listitem>
			<listitem>
				<para>IPS/IDS</para>
				<para>-Action</para>
				<para>-Classification</para>
				<para>-Domain Name</para>
				<para>-IPS Group</para>
				<para>-GID</para>
				<para>-Revision</para>
				<para>-Severity</para>
				<para>-SID</para>
			</listitem>
			<listitem>
				<para>Flow</para>
				<para>-Biflow direction</para>
				<para>-Direction</para>
			</listitem>
			<listitem>
				<para>Interface</para>
				<para>-INPUT SNMP</para>
				<para>-OUTPUT SNMP</para>
				<para>-INPUT VRF</para>
				<para>-OUTPUT VRF</para>
				<para>-Wireless Starion</para>
				<para>-Client RSSI</para>
				<para>-Client RSSI Value</para>
				<para>-Client SNR</para>
				<para>-Client SNR Value</para>
			</listitem>
			<listitem>
				<para>Location</para>
				<para>-SRC Country</para>
				<para>-SRC AS </para>
				<para>-DST Country</para>
				<para>-DST AS</para>
				<para>-Service Provider</para>
				<para>-Namespace</para>
				<para>-Deployment</para>
				<para>-Market</para>
				<para>-Organization</para>
			</listitem>
			<listitem>
				<para>Network</para>
				<para>-IP lenght</para>
				<para>-Protocol</para>
				<para>-Sensor Type</para>
				<para>-SRC NET Address</para>
				<para>-DST NET Address</para>
			</listitem>
			<listitem>
				<para>Transport</para>
				<para>-SRC Port</para>
				<para>-DST Port</para>
			</listitem>
		</itemizedlist>
		<important>
			<title>Importante</title>
			<para>Gracias a la opción IPS Group, el usuario puede crear grupos con diferentes segmentos IPS. Esto le permite aplicar diferentes políticas a diferentes grupos de segmentos, a diferencia de lo que sucedía en versiones anteriores.</para>
			<para>Con una única máquina se pueden crear numerosos entornos en los que aplicar diferentes reglas.</para>
		</important>
	</section>
</chapter>
