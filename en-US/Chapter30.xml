<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "manual.ent">
<!ENTITY PRODUCT "Documentation">
<!ENTITY BOOKID "manual">
<!ENTITY YEAR "2019">
<!ENTITY HOLDER "Eneo TecnologÃ­a S.L. |">
]>

<chapter>
	<title>Uses Cases/title>
	<para>In this chapter we will show some uses cases of Redborder. Some of them: </para>
	<section>
		<title>Use Case: Tracking an IP with Redborder</title>
		<para>We can use Redborder to track a suspicious IP. Its possible to learn about its behaviour using Traffic module</para>
		<para>First of all we must know the ip we want to track. Once we have the IP we will go to Traffic module</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch30_img001_a.png"/>
			</imageobject>
			<caption>
				<para>Tracking an IP: Traffic module</para>
			</caption>
		</mediaobject>
		<para>Once in Traffic module we can use the Advanced Search from Filter button to see only the traffic generated by that ip</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch30_img001_b.png"/>
			</imageobject>
			<caption>
				<para>Tracking an IP: Advanced Search in Traffic module</para>
			</caption>
		</mediaobject>
		<para>Here we can set the suspicious ip to filter all the traffic. We will use LAN IP metric for that purpose.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch30_img001_c.png"/>
			</imageobject>
			<caption>
				<para>Tracking an IP: Filtering IP</para>
			</caption>
		</mediaobject>
		<para>When we apply the filter we will see only the traffic for that ip.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch30_img001_d.png"/>
			</imageobject>
			<caption>
				<para>Tracking an IP: Traffic filtered</para>
			</caption>
		</mediaobject>	
		<para>Is possible to add new metrics to see the behaviour of the ip and what is doing in our network.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch30_img001_e.png"/>
			</imageobject>
			<caption>
				<para>Tracking an IP: Adding new metrics</para>
			</caption>
		</mediaobject>
		<para>Now we can see what ports are being used by this IP.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch30_img001_f.png"/>
			</imageobject>
			<caption>
				<para>Tracking an IP: Ports being used by suspicious IP</para>
			</caption>
		</mediaobject>
		<para>With this use case we can see how Redborder is able to filter the traffic for one or more IP so the user can detect bad behaviours for particular ip's, being able to track ip's with only a few clicks.</para>
	</section>
	<section>
	<title>Use Case: Brute force authentication attack alert</title>
	<para>We can use Redborder to alert of possible brute force attacks thanks to the use of its correlation engine and the rules that are established.</para>
	<para>First, we must go to the Correlation Engine Rules section located in the Tools part.</para>
	<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch30_img002_a.png"/>
			</imageobject>
			<caption>
				<para>CEP rules</para>
			</caption>
	</mediaobject>
	<para>Then we will activate the rule we want to use. In this case: SSH Brute Force Authentication. Finally, we must apply the changes.</para>
	<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch30_img002_b.png"/>
			</imageobject>
			<caption>
				<para>CEP rules</para>
			</caption>
	</mediaobject>
	<para>This rule is capable of generating an alert when 200 unsuccessful log-in attempts occur in a 20 minute time window on a Linux machine via SSH protocol. For this, it is necessary to have the corresponding vault sensor created previously by referring to the IP of the machine which we want to protect.</para>
	<para>Once this is done, in case of receiving a brute force attack, we could visualize the corresponding alert by accessing the Vault module. To be able to view it easily, we can add a sensor tab and filter by CEP.</para>
	<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch30_img002_c.png"/>
			</imageobject>
			<caption>
				<para>Vault module: Brute force attack alert.</para>
			</caption>
	</mediaobject>
	<para>We can also display the alert message if we switch to the message tab.</para>
	<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch30_img002_d.png"/>
			</imageobject>
			<caption>
				<para>Vault module: Brute force attack alert message.</para>
			</caption>
	</mediaobject>
	</section>
</chapter>
