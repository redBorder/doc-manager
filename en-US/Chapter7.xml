<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "manual.ent">
<!ENTITY PRODUCT "Documentation">
<!ENTITY BOOKID "manual">
<!ENTITY YEAR "2015">
<!ENTITY HOLDER "Eneo Tecnología S.L. |">
]>
<chapter>
		<title>Events: IPS</title>
		<para>Thanks to redBorder, you can get active control over your network traffic. The analysis is the first step to maintain effective security policy. But you must have a way to intervene in the most critical moments and thus, prevent threats from becoming attacks.</para>
		<para>The IPS App ensures maximum protection of your network to be an active system capable of blocking traffic from a particular IP, or exclude a package for prior analysis with suspicious results, or that meets some of the rules set by the user.</para>
		<para>Visibility for analysis and security for active control. This is the combination that makes redBorder the best Open Source operational intelligence platform on the market.</para>
		<note>
			<title>Note</title>
			<para>In the next picture we can see that the IPS section presents a similar structure to the Flow interface section. It is for this reason that to know the structure and operation of the section, the user can refer to the chapter “Events: Flow". </para>
		</note>
		<para>In the case of the IPS App, the measurement units in which the data is shown in graphs or aggregation, appear under the name  <literal>Events</literal>.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img000.png"/>
			</imageobject>
			<textobject>
				<phrase>IPS general view</phrase>
			</textobject>
			<caption>
				<para>IPS general view</para>
			</caption>
		</mediaobject>
	<section>
		<title>Events</title>
		<para>In the header of the submenu we find the section <emphasis>Events</emphasis> (between the View tabs and granularity) which allows us to select the aggregation to display the IPS events.</para>
		<itemizedlist mark="bullet">
			<listitem>
				<para><literal>Events</literal></para>
			</listitem>
			<listitem>
				<para><literal>Events/s</literal></para>
			</listitem>
			<listitem>
				<para><literal>Signature</literal></para>
			</listitem>
		</itemizedlist>
		<note>
			<title>Note</title>
			<para>These options apply to the Tops and Compare views. In the case of the Unique view, it does not apply; they're included in the Raw view, as well as other options detailed below.</para>
		</note>
		<section>
			<title>Events</title> 
			<para>In the views <literal>Tops</literal> and <literal>Compare</literal> this option allows us to see the total number of events that have occurred as attributes. By resting the mouse over the view, it will display the date, exact time and the total number of events that have occurred in that time period for the selected attribute.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img026.png"/>
				</imageobject>
				<textobject>
					<phrase>Events/sensor</phrase>
				</textobject>
				<caption>
					<para>Events/sensor</para>
				</caption>
			</mediaobject>
			<para>Remember that it is possible to analyze further by adding attributes tabs. For example, in the following screen shot we see the total signatures that have been received over a period of time, or in the second case, the total number of events generated by the source IPs that have interacted with a network. </para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img027.png"/>
				</imageobject>	
				<textobject>
					<phrase>Events/signatures</phrase>
				</textobject>
				<caption>
					<para>Events/signatures</para>
				</caption>
			</mediaobject>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img028.png"/>
				</imageobject>
				<textobject>
					<phrase>Events/SRC</phrase>
				</textobject>
				<caption>
					<para>Events/SRC</para>
				</caption>
			</mediaobject>
		</section>
		<section>
			<title>Events/s</title> 
			<para>Shows the total of events that have occurred in a second for a given attribute. It offers the highest degree of granularity.</para> 
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img029.png"/>
				</imageobject>
				<textobject>
					<phrase>Events/s-signatures</phrase>
				</textobject>
				<caption>
					<para>Events/s-signatures</para>
				</caption>
			</mediaobject>
		</section>
		<section>
			<title>Signatures</title> 
			<para>With this option, the user can see in the data table the total number of signatures that have run for a given attribute: sensor, source IPs, destination IPs, etc. If a tab is added to the attribute <literal>Signature</literal> we will see that the distribution of signature per signature had, logically, is a value of 1. However, the summary will provide very useful information. </para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img030.png"/>
				</imageobject>
				<textobject>
					<phrase>Signatures/sensor</phrase>
				</textobject>
				<caption>
					<para>Signatures/sensor</para>
				</caption>
			</mediaobject>
		</section>
	</section>
	<section>
		<title>IPS event management in the Raw view</title>
		<para>The Raw view allows us to display all events collected by the IPS sensors by attribute and segmented per time slot. Combined with the Stream graph, it allows us also to display the data flow that is occurring within the network. </para>
		<para>Each column of the data table shows values corresponding to the selected attributes and the time interval between events  <literal>Timestamp</literal>.</para>
		<para>In this table we can perform different actions:</para>
		<itemizedlist mark="bullet">
			<listitem>
				<para>Time interval or <literal>Timestamp:</literal> we can check the time interval that is referenced to show the number of events that have occurred in that time.</para>
			</listitem>
			<listitem>
				<para>Check event information: click on the icon “Edit" for greater granularity.</para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="350" fileref="images/ch11_img012.png"/>
					</imageobject>
					<caption>
						<para>Icon “Edit"</para>
					</caption>
				</mediaobject>
				<para>When you have reached the limit of granularity at which you can display events, this icon will change in the information:</para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="350" fileref="images/ch11_img012b.png"/>
					</imageobject>
					<caption>
						<para>Timestamp details: event information</para>
					</caption>
				</mediaobject>
				<para>Clicking on it will access a screen that provides the complete information associated with each of the events consigned in that time interval.</para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img012.png"/>
					</imageobject>
					<caption>
						<para>Event information</para>
					</caption>
				</mediaobject>
			</listitem>
			<listitem>
				<para><literal>Create object</literal>: some of the attributes shown in the event information allows the possibility of converting them to an Object. This means that these values can add a name and a description to them, allowing the location of an item more quickly and easily.</para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img013.png"/>
					</imageobject>
					<caption>
						<para>Create object</para>
					</caption>
				</mediaobject>
			</listitem>
		</itemizedlist>
		<note>
			<title>Note</title>
			<para>Remember that the maximum granularity available is 1m.</para>
		</note>	
		<section>
			<title>Raw View: IPS event information</title>
			<para>When we reach the maximum granularity available to consult the events registered by the sensor, we access a screen in which we will see a tab that includes the information details associated with the following perameters:</para>
			<itemizedlist mark="circle">
				<listitem>
					<para>Datalink</para>
				</listitem>
				<listitem>
					<para>File</para>
				</listitem>
				<listitem>
					<para>IPS/IDS</para>
				</listitem>
				<listitem>
					<para>Localization</para>
				</listitem>
				<listitem>
					<para>Red</para>
				</listitem>
				<listitem>
					<para>Transport</para>
				</listitem>
			</itemizedlist>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img034.png"/>
				</imageobject>
				<textobject>
					<phrase>Event information details</phrase>
				</textobject>
				<caption>
					<para>Event information details</para>
				</caption>
			</mediaobject>
		</section>
		<section>	
			<title>Raw View: event rules, policies and actions</title>
			<para>In addition to obtaining detailed information on each of the events, you can perform actions on them to help manage the display, so you can optimize the analysis and monitoring of your networks.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img035.png"/>
				</imageobject>
				<textobject>
					<phrase>Actions for event displays</phrase>
				</textobject>
				<caption>
					<para>Actions for event displays</para>
				</caption>
			</mediaobject>
			<para>The actions you can perform on this screen are the following:</para>
			<itemizedlist mark="circle">
				<listitem>
					<para>References: allows us to consult outside sources for information about known vulnerabilities.</para>
					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img014.png"/>
						</imageobject>
						<textobject>
							<phrase>References: CVE</phrase>
						</textobject>
						<caption>
							<para>References: CVE</para>
						</caption>
					</mediaobject>
				</listitem>
				<listitem>
					<para>View rule: detailed information about the rule associated with the sensor.</para>
					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img015.png"/>
						</imageobject>
						<textobject>
							<phrase>Rule information</phrase>
						</textobject>
						<caption>
							<para>Rule information</para>
						</caption>
					</mediaobject>
				</listitem>
				<listitem>
					<para>Policy rule: shows the policy or policies applied to activate the alert being queried. This option includes many actions that can be performed on the policies, and you will see more in the chapter “Setting policies".</para> 
					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img016.png"/>
						</imageobject>
						<textobject>
							<phrase>Policy rule</phrase>
						</textobject>
						<caption>
							<para>Policy rule</para>
						</caption>
					</mediaobject>
				</listitem>
				<listitem>
					<para>Raw View: allows the display of raw data events.</para>
					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img017.png"/>
						</imageobject>
						<textobject>
							<phrase>Raw View</phrase>
						</textobject>
						<caption>
							<para>Raw View</para>
						</caption>
					</mediaobject>
				</listitem>
				<listitem>
					<para>Event Suppression: suppression of recurrent events, or those which do not need information.</para>
					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img018.png"/>
						</imageobject>
						<textobject>
							<phrase>Remove event</phrase>
						</textobject>
						<caption>
							<para>Remove event</para>
						</caption>
					</mediaobject>
				</listitem>
				<listitem>
					<para>Event Filtering: there are three types of filters for displaying events; the user can also determine whether the event tracking is performed by source or destination.</para>
					<mediaobject>
						<imageobject>
							<imagedata scalefit="1" align="center" width="350" fileref="images/ch07_img019.png"/>
						</imageobject>
						<textobject>
							<phrase>Filter event</phrase>
						</textobject>
						<caption>
							<para>Filter event</para>
						</caption>
					</mediaobject>
					<para>-Limit: limits the number of events that are shown in a period of time that we have indicated, and are found below the selected shapes, ignoring the rest of the events under the same signature. </para>
					<para>-Threshold: Selects the number of times an event must occur in a certain period of time for the alert to be displayed.</para>
					<para>-Both: the alert is displayed only once every n times the event has happened in a period of time.</para>
				</listitem>
			</itemizedlist>	
		</section>
	</section>
	<section>
		<title>Available attributes for IPS</title>
		<note>
			<title>Note</title>
			<para>The options shown in the tab <literal>Add tab</literal> are the same for all the views, except Compare view, which shows us as timing options with which we can consult the events: weekly or monthly.</para>
		</note>
		<para>The following are the attributes that the user has available to apply to the IPS and the different aspects that refer to each:</para>
		<itemizedlist mark="circle">
			<listitem>
				<para>Datalink</para>
				<para>-Ethelength</para>
				<para>-ICMP Type</para>
				<para>-SRC MAC</para>
				<para>-SRC Vendor</para>
				<para>-DST MAC</para>
				<para>-DST Vendor</para>
				<para>-TOS</para>
				<para>-TTL</para>
				<para>-VLAN ID</para>
			</listitem>
			<listitem>
				<para>File</para>
				<para>-SHA256</para>
				<para>-File size</para>
				<para>-File URI</para>
				<para>-File hostname</para>
			</listitem>
			<listitem>
				<para>IPS/IDS</para>
				<para>-Action</para>
				<para>-Classification</para>
				<para>-Domain Name</para>
				<para>-IPS Group</para>
				<para>-GID</para>
				<para>-Revision</para>
				<para>-Severity</para>
				<para>-SID</para>
			</listitem>
			<listitem>
				<para>Flow</para>
				<para>-Biflow direction</para>
				<para>-Direction</para>
			</listitem>
			<listitem>
				<para>Interface</para>
				<para>-INPUT SNMP</para>
				<para>-OUTPUT SNMP</para>
				<para>-INPUT VRF</para>
				<para>-OUTPUT VRF</para>
				<para>-Wireless Starion</para>
				<para>-Client RSSI</para>
				<para>-Client RSSI Value</para>
				<para>-Client SNR</para>
				<para>-Client SNR Value</para>
			</listitem>
			<listitem>
				<para>Location</para>
				<para>-SRC Country</para>
				<para>-SRC AS </para>
				<para>-DST Country</para>
				<para>-DST AS</para>
				<para>-Service Provider</para>
				<para>-Namespace</para>
				<para>-Deployment</para>
				<para>-Market</para>
				<para>-Organization</para>
			</listitem>
			<listitem>
				<para>Network</para>
				<para>-IP length</para>
				<para>-Protocol</para>
				<para>-Sensor Type</para>
				<para>-SRC NET Address</para>
				<para>-DST NET Address</para>
			</listitem>
			<listitem>
				<para>Transport</para>
				<para>-SRC Port</para>
				<para>-DST Port</para>
			</listitem>
		</itemizedlist>
		<important>
			<title>Important</title>
			<para>Thanks to the IPS Group option, the user can create groups with different IPS segments. This allows you to apply different policies to different groups of segments, unlike the previous versions.</para>
			<para>With a single machine, you can create many environments where different rules apply.</para>
		</important>
	</section>
</chapter>
